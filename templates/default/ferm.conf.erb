# Generated by Chef run for <%= node['fqdn'] %>

table filter {
  chain INPUT {
    policy DROP;

    mod state state INVALID DROP;
    mod state state (ESTABLISHED RELATED) ACCEPT;

    interface lo ACCEPT;

    proto icmp icmp-type (echo-reply echo-request) mod state state NEW ACCEPT;
  }

  chain OUTPUT {
    policy ACCEPT;
    mod state state INVALID DROP;
  }

  chain FORWARD {
    policy ACCEPT;
    mod state state INVALID DROP;
  }
}

domain ip6 table filter {
  chain INPUT {
    policy DROP;

    mod state state INVALID DROP;
    mod state state (ESTABLISHED RELATED) ACCEPT;

    interface lo ACCEPT;

    proto ipv6-icmp ACCEPT;
  }

  chain OUTPUT {
    policy ACCEPT;
    mod state state INVALID DROP;
  }

  chain FORWARD {
    policy ACCEPT;
    mod state state INVALID DROP;
  }
}

@include '/etc/ferm/ferm.d/';

