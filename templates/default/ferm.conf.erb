# Generated by Chef run for <%= node['fqdn'] %>

table filter {
  chain INPUT {
    policy DROP;

    mod conntrack ctstate INVALID DROP;
    mod conntrack ctstate (ESTABLISHED RELATED) ACCEPT;

    interface lo ACCEPT;

    proto icmp ACCEPT;
  }

  chain OUTPUT {
    policy ACCEPT;
    mod conntrack ctstate INVALID DROP;
  }

  chain FORWARD {
    policy ACCEPT;
    mod conntrack ctstate INVALID DROP;
  }
}

domain ip6 table filter {
  chain INPUT {
    policy DROP;

    mod conntrack ctstate INVALID DROP;
    mod conntrack ctstate (ESTABLISHED RELATED) ACCEPT;

    interface lo ACCEPT;

    proto ipv6-icmp ACCEPT;
  }

  chain OUTPUT {
    policy ACCEPT;
    mod conntrack ctstate INVALID DROP;
  }

  chain FORWARD {
    policy ACCEPT;
    mod conntrack ctstate INVALID DROP;
  }
}

@include '/etc/ferm/ferm.d/';

